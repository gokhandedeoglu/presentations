{"version":3,"sources":["direct_dom_renderer_integration_spec.js"],"names":[],"mappings":"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","file":"/home/korchev/github/angular/modules/angular2/test/render/dom/direct_dom_renderer_integration_spec.js","sourcesContent":["import {\n  AsyncTestCompleter,\n  beforeEach,\n  ddescribe,\n  describe,\n  el,\n  elementText,\n  expect,\n  iit,\n  inject,\n  it,\n  xit,\n  SpyObject,\n} from 'angular2/test_lib';\n\nimport {DOM} from 'angular2/src/dom/dom_adapter';\n\nimport {ProtoView, Template, ViewContainerRef, EventDispatcher, DirectiveMetadata} from 'angular2/src/render/api';\n\nimport {IntegrationTestbed, LoggingEventDispatcher, FakeEvent} from './integration_testbed';\n\nexport function main() {\n  describe('DirectDomRenderer integration', () => {\n    var testbed, renderer, rootEl, rootProtoViewRef, eventPlugin, compile;\n\n    function createRenderer({urlData, viewCacheCapacity, shadowDomStrategy, templates}={}) {\n      testbed = new IntegrationTestbed({\n        urlData: urlData,\n        viewCacheCapacity: viewCacheCapacity,\n        shadowDomStrategy: shadowDomStrategy,\n        templates: templates\n      });\n      renderer = testbed.renderer;\n      rootEl = testbed.rootEl;\n      rootProtoViewRef = testbed.rootProtoViewRef;\n      eventPlugin = testbed.eventPlugin;\n      compile = (template, directives) => testbed.compile(template, directives);\n    }\n\n    it('should create root views while using the given elements in place', () => {\n      createRenderer();\n      var viewRefs = renderer.createView(rootProtoViewRef);\n      expect(viewRefs.length).toBe(1);\n      expect(viewRefs[0].delegate.rootNodes[0]).toEqual(rootEl);\n    });\n\n    it('should add a static component', inject([AsyncTestCompleter], (async) => {\n      createRenderer();\n      var template = new Template({\n        componentId: 'someComponent',\n        inline: 'hello',\n        directives: []\n      });\n      renderer.compile(template).then( (pv) => {\n        var mergedProtoViewRefs = renderer.mergeChildComponentProtoViews(rootProtoViewRef, [pv.render]);\n        renderer.createView(mergedProtoViewRefs[0]);\n        expect(rootEl).toHaveText('hello');\n        async.done();\n      });\n    }));\n\n    it('should add a a dynamic component', inject([AsyncTestCompleter], (async) => {\n      createRenderer();\n      var template = new Template({\n        componentId: 'someComponent',\n        inline: 'hello',\n        directives: []\n      });\n      renderer.compile(template).then( (pv) => {\n        var rootViewRef = renderer.createView(rootProtoViewRef)[0];\n        var childComponentViewRef = renderer.createView(pv.render)[0];\n        renderer.setDynamicComponentView(rootViewRef, 0, childComponentViewRef);\n        expect(rootEl).toHaveText('hello');\n        async.done();\n      });\n    }));\n\n    it('should update text nodes', inject([AsyncTestCompleter], (async) => {\n      createRenderer();\n      compile('{{a}}', [someComponent]).then( (pvRefs) => {\n        var viewRefs = renderer.createView(pvRefs[0]);\n        renderer.setText(viewRefs[1], 0, 'hello');\n        expect(rootEl).toHaveText('hello');\n        async.done();\n      });\n    }));\n\n    it('should update element properties', inject([AsyncTestCompleter], (async) => {\n      createRenderer();\n      compile('<input [value]=\"someProp\">', []).then( (pvRefs) => {\n        var viewRefs = renderer.createView(pvRefs[0]);\n        renderer.setElementProperty(viewRefs[1], 0, 'value', 'hello');\n        expect(DOM.childNodes(rootEl)[0].value).toEqual('hello');\n        async.done();\n      });\n    }));\n\n    it('should add and remove views to and from containers', inject([AsyncTestCompleter], (async) => {\n      createRenderer();\n      compile('<template>hello</template>', []).then( (pvRefs) => {\n        var viewRef = renderer.createView(pvRefs[0])[1];\n        var vcProtoViewRef = pvRefs[2];\n        var vcRef = new ViewContainerRef(viewRef, 0);\n        var childViewRef = renderer.createView(vcProtoViewRef)[0];\n\n        expect(rootEl).toHaveText('');\n        renderer.insertViewIntoContainer(vcRef, childViewRef);\n        expect(rootEl).toHaveText('hello');\n        renderer.detachViewFromContainer(vcRef, 0);\n        expect(rootEl).toHaveText('');\n\n        async.done();\n      });\n    }));\n\n    it('should cache views', inject([AsyncTestCompleter], (async) => {\n      createRenderer({\n        viewCacheCapacity: 2\n      });\n      compile('<template>hello</template>', []).then( (pvRefs) => {\n        var vcProtoViewRef = pvRefs[2];\n        var viewRef1 = renderer.createView(vcProtoViewRef)[0];\n        renderer.destroyView(viewRef1);\n        var viewRef2 = renderer.createView(vcProtoViewRef)[0];\n        var viewRef3 = renderer.createView(vcProtoViewRef)[0];\n        expect(viewRef2.delegate).toBe(viewRef1.delegate);\n        expect(viewRef3.delegate).not.toBe(viewRef1.delegate);\n\n        async.done();\n      });\n    }));\n\n    // TODO(tbosch): This is not working yet as we commented out\n    // the event expression processing...\n    xit('should handle events', inject([AsyncTestCompleter], (async) => {\n      createRenderer();\n      compile('<input (change)=\"$event.target.value\">', []).then( (pvRefs) => {\n        var viewRef = renderer.createView(pvRefs[0])[1];\n        var dispatcher = new LoggingEventDispatcher();\n        renderer.setEventDispatcher(viewRef, dispatcher);\n        var inputEl = DOM.childNodes(rootEl)[0];\n        inputEl.value = 'hello';\n        eventPlugin.dispatchEvent('change', new FakeEvent(inputEl));\n        expect(dispatcher.log).toEqual([[0, 'change', ['hello']]]);\n        async.done();\n      });\n\n    }));\n\n  });\n}\n\nvar someComponent = new DirectiveMetadata({\n  id: 'someComponent',\n  type: DirectiveMetadata.COMPONENT_TYPE,\n  selector: 'some-comp'\n});\n"]}